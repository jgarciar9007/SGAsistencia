{% extends "base.html" %}
{% block content %}
<div class="container mt-4">
  <div class="row justify-content-center">
    <div class="col-md-10">
      <div class="card shadow-lg border-0">
        <div class="card-header bg-success text-white py-3">
          <h5 class="mb-0"><i class="bi bi-briefcase-fill me-2"></i>Contratar Candidato</h5>
        </div>
        <div class="card-body">
          <div class="alert alert-info">
            Estás promoviendo a <strong>{{ candidato.nombre_completo }}</strong> a Empleado. Sus datos básicos se han copiado. Revisa y completa la información laboral.
          </div>
          
          <form method="post" enctype="multipart/form-data">
            {% csrf_token %}
            
            <div class="row g-3">
               <!-- Seccion 1: Identidad (Readonly o prellena) -->
               <div class="col-md-4">
                 <label class="form-label">Nombre</label>
                 {{ form.nombre }}
               </div>
               <div class="col-md-4">
                 <label class="form-label">Apellido</label>
                 {{ form.apellido }}
               </div>
               <div class="col-md-4">
                 <label class="form-label">Doc ID</label>
                 {{ form.doc_id }}
               </div>

               <!-- Seccion 2: Laboral -->
               <div class="col-12"><hr><h6>Datos Laborales</h6></div>
               <div class="col-md-4">
                 <label class="form-label">Número Empleado/Nómina</label>
                 {{ form.numero }}
                 {{ form.numero.errors }}
               </div>
               <div class="col-md-4">
                 <label class="form-label">Tipo de Contrato</label>
                 {{ form.tipo_vinculacion }}
               </div>
               <div class="col-md-4">
                 <label class="form-label">Puesto</label>
                 {{ form.puesto }}
               </div>
               
               <div class="col-md-4">
                 <label class="form-label">Departamento</label>
                 {{ form.departamento }}
               </div>
               <div class="col-md-4">
                 <label class="form-label">Área</label>
                 {{ form.area }}
               </div>
               <div class="col-md-4">
                 <label class="form-label">Sección</label>
                 {{ form.seccion }}
               </div>
               <div class="col-md-4">
                 <label class="form-label fw-bold">Salario Bruto</label>
                 <div class="input-group">
                    <span class="input-group-text">FCFA</span>
                    {{ form.salario_base }}
                 </div>
               </div>

               <!-- Debugging: Mostrar errores de todos los campos si hay alguno -->
               {% if form.errors %}
               <div class="col-12">
                  <div class="alert alert-warning mt-3">
                     <strong>Por favor corrige los siguientes errores:</strong>
                     <ul>
                       {% for field in form %}
                           {% for error in field.errors %}
                               <li>{{ field.label }}: {{ error }}</li>
                           {% endfor %}
                       {% endfor %}
                       {% for error in form.non_field_errors %}
                           <li>{{ error }}</li>
                       {% endfor %}
                     </ul>
                  </div>
               </div>
               {% endif %}

               <!-- Seccion 3: Contacto -->
               <div class="col-12"><hr><h6>Contacto</h6></div>
               <div class="col-md-6">
                 <label class="form-label">Email</label>
                 {{ form.email }}
               </div>
               <div class="col-md-6">
                 <label class="form-label">Teléfono</label>
                 {{ form.telefono }}
               </div>
               <div class="col-12">
                 <label class="form-label">Dirección</label>
                 {{ form.direccion }}
               </div>

               <div class="col-12 mt-4 d-flex justify-content-end gap-2">
                 <a href="{% url 'empleados:candidato_list' %}" class="btn btn-outline-secondary">Cancelar</a>
                 <button type="submit" class="btn btn-success btn-lg">Confirmar Contratación</button>
               </div>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}
